# Network Architecture Diagram

## Overall Network Topology

```
                                                  INTERNET
                                                      │
                                                      │
                                                      ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                  HEADQUARTERS                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ Firewall &  │     │   Load      │     │  VPN        │     │ Intrusion   │   │
│  │ NAT Gateway │◄───▶│  Balancer   │◄───▶│  Server     │◄───▶│ Detection   │   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│         ▲                   ▲                   ▲                   ▲           │
│         │                   │                   │                   │           │
│         ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         INTERNAL NETWORK BACKBONE                        │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                   ▲           │
│         │                   │                   │                   │           │
│         ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ Application │     │  Database   │     │ Monitoring  │     │    Kafka    │   │
│  │   Servers   │     │   Servers   │     │   Servers   │     │   Cluster   │   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
                 ▲                   ▲                   ▲
                 │                   │                   │
                 │                   │                   │
                 │                   │                   │
                 ▼                   ▼                   ▼
┌───────────────────────┐   ┌───────────────────────┐   ┌───────────────────────┐
│    SECURE WIREGUARD   │   │    SECURE WIREGUARD   │   │    SECURE WIREGUARD   │
│    VPN CONNECTIONS    │   │    VPN CONNECTIONS    │   │    VPN CONNECTIONS    │
└───────────────────────┘   └───────────────────────┘   └───────────────────────┘
                 ▲                   ▲                   ▲
                 │                   │                   │
                 │                   │                   │
                 │                   │                   │
                 ▼                   ▼                   ▼
┌───────────────────────┐   ┌───────────────────────┐   ┌───────────────────────┐
│      BRANCH 001       │   │      BRANCH 002       │   │      BRANCH 089       │
└───────────────────────┘   └───────────────────────┘   └───────────────────────┘
```

## Branch Network Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                                  BRANCH OFFICE                                   │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ Firewall &  │     │  WireGuard  │     │ Redundant   │     │ Local DNS   │   │
│  │ Router      │◄───▶│  VPN Client │◄───▶│ Connection  │◄───▶│ Server      │   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│         ▲                   ▲                                       ▲           │
│         │                   │                                       │           │
│         ▼                   ▼                                       ▼           │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         BRANCH NETWORK SWITCH                            │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                   ▲           │
│         │                   │                   │                   │           │
│         ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ Application │     │  Database   │     │ Monitoring  │     │ Teller      │   │
│  │   Server    │     │   Server    │     │   Agent     │     │ Workstations│   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Detailed HQ Server Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                             HQ SERVER ARCHITECTURE                               │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         DMZ NETWORK SEGMENT                              │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                   ▲           │
│         │                   │                   │                   │           │
│         ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ VPN         │     │ API         │     │ Reverse     │     │ Web         │   │
│  │ Servers     │     │ Gateways    │     │ Proxies     │     │ Servers     │   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      INTERNAL NETWORK SEGMENT                            │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                   ▲           │
│         │                   │                   │                   │           │
│         ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ ERPNext     │     │ Kafka       │     │ Sync        │     │ Monitoring  │   │
│  │ Application │     │ Cluster     │     │ Services    │     │ Stack       │   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      DATABASE NETWORK SEGMENT                            │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                   ▲           │
│         │                   │                   │                   │           │
│         ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ PostgreSQL  │     │ Redis       │     │ Backup      │     │ Vault       │   │
│  │ Cluster     │     │ Cluster     │     │ Storage     │     │ Secrets     │   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Detailed Branch Server Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           BRANCH SERVER ARCHITECTURE                             │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         EDGE NETWORK SEGMENT                             │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                               │
│         │                   │                   │                               │
│         ▼                   ▼                   ▼                               │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                       │
│  │ VPN         │     │ Reverse     │     │ Local       │                       │
│  │ Client      │     │ Proxy       │     │ Firewall    │                       │
│  └─────────────┘     └─────────────┘     └─────────────┘                       │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      APPLICATION NETWORK SEGMENT                         │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                   ▲           │
│         │                   │                   │                   │           │
│         ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ ERPNext     │     │ Sync        │     │ Kafka       │     │ Monitoring  │   │
│  │ Application │     │ Service     │     │ Broker      │     │ Agent       │   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      DATABASE NETWORK SEGMENT                            │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                               │
│         │                   │                   │                               │
│         ▼                   ▼                   ▼                               │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                       │
│  │ PostgreSQL  │     │ Redis       │     │ Local       │                       │
│  │ Database    │     │ Cache       │     │ Backup      │                       │
│  └─────────────┘     └─────────────┘     └─────────────┘                       │
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                      CLIENT NETWORK SEGMENT                              │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│         ▲                   ▲                   ▲                               │
│         │                   │                   │                               │
│         ▼                   ▼                   ▼                               │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐                       │
│  │ Teller      │     │ Admin       │     │ Branch      │                       │
│  │ Workstations│     │ Workstations│     │ Printers    │                       │
│  └─────────────┘     └─────────────┘     └─────────────┘                       │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Monitoring Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           MONITORING ARCHITECTURE                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│                              HEADQUARTERS                                        │
│                                                                                 │
│  ┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐   │
│  │ Prometheus  │     │ Grafana     │     │ Alert       │     │ ELK         │   │
│  │ Federation  │     │ Dashboards  │     │ Manager     │     │ Stack       │   │
│  └─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘   │
│         ▲                   ▲                   ▲                   ▲           │
│         │                   │                   │                   │           │
│         │                   │                   │                   │           │
│         │                   │                   │                   │           │
│         │                   │                   │                   │           │
│         │                   │                   │                   │           │
│         ▼                   ▼                   ▼                   ▼           │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                         SECURE VPN TUNNEL                                │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
                 ▲                   ▲                   ▲
                 │                   │                   │
                 │                   │                   │
                 │                   │                   │
                 ▼                   ▼                   ▼
┌───────────────────────┐   ┌───────────────────────┐   ┌───────────────────────┐
│      BRANCH 001       │   │      BRANCH 002       │   │      BRANCH 089       │
│                       │   │                       │   │                       │
│  ┌─────────────┐      │   │  ┌─────────────┐      │   │  ┌─────────────┐      │
│  │ Prometheus  │      │   │  │ Prometheus  │      │   │  │ Prometheus  │      │
│  │ Local       │      │   │  │ Local       │      │   │  │ Local       │      │
│  └─────────────┘      │   │  └─────────────┘      │   │  └─────────────┘      │
│         ▲             │   │         ▲             │   │         ▲             │
│         │             │   │         │             │   │         │             │
│         ▼             │   │         ▼             │   │         ▼             │
│  ┌─────────────┐      │   │  ┌─────────────┐      │   │  ┌─────────────┐      │
│  │ Node        │      │   │  │ Node        │      │   │  │ Node        │      │
│  │ Exporters   │      │   │  │ Exporters   │      │   │  │ Exporters   │      │
│  └─────────────┘      │   │  └─────────────┘      │   │  └─────────────┘      │
│                       │   │                       │   │                       │
└───────────────────────┘   └───────────────────────┘   └───────────────────────┘
``` 